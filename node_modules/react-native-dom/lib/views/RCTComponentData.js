var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _objectSpread3=_interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _invariant=_interopRequireDefault(require("invariant"));var _RCTBridge=_interopRequireWildcard(require("./../bridge/RCTBridge"));var _RCTModule=require("./../bridge/RCTModule");var _UIView=_interopRequireDefault(require("./../base/UIView"));var _RCTEventDispatcher=require("./../bridge/RCTEventDispatcher");var _RCTText=_interopRequireDefault(require("./Text/RCTText"));var _RCTRawText=_interopRequireDefault(require("./Text/RCTRawText"));var _RCTTextInput=_interopRequireDefault(require("./Text/RCTTextInput"));function moduleNameForClass(cls){var name=cls.moduleName;if(name!=null){if(name.startsWith("RK")){name="RCT"+name.substring(2);}if(name.endsWith("Manager")){name=name.substring(0,name.length-"Manager".length);}return name;}return"";}var RCTComponentData=function(){function RCTComponentData(managerClass,bridge){(0,_classCallCheck2.default)(this,RCTComponentData);this.bridge=bridge;this.managerClass=managerClass;this.viewPropBlocks={};this.shadowPropBlocks={};this.name=moduleNameForClass(managerClass);}(0,_createClass2.default)(RCTComponentData,[{key:"generatePropConfig",value:function generatePropConfig(rawPropConfig){return rawPropConfig.reduce(function(propConfig,raw){return(0,_objectSpread3.default)({},propConfig,(0,_defineProperty2.default)({},raw.name,{type:raw.type,setter:raw.setter?raw.setter:function(view,value){view[raw.name]=value;}}));},{});}},{key:"createView",value:function createView(tag){var view=this.manager.view();view.reactTag=tag;return view;}},{key:"createShadowView",value:function createShadowView(tag){var shadowView=this.manager.shadowView();shadowView.reactTag=tag;return shadowView;}},{key:"setPropsForView",value:function setPropsForView(props,view){var _this=this;if(props){Object.keys(props).forEach(function(propName){if(_this.propConfig.hasOwnProperty(propName)){var propConfig=_this.propConfig[propName];var propValue=props[propName];var setter=propConfig.setter;setter(view,propValue);}});}}},{key:"setPropsForShadowView",value:function setPropsForShadowView(props,shadowView){var _this2=this;if(props){Object.keys(props).forEach(function(propName){if(_this2.shadowPropConfig.hasOwnProperty(propName)){var propConfig=_this2.shadowPropConfig[propName];var propValue=props[propName];var setter=propConfig.setter;setter(shadowView,propValue);}});}}},{key:"manager",get:function get(){if(this._manager==null){this._manager=this.bridge.moduleForClass(this.managerClass);}(0,_invariant.default)(this._manager,"RCTComponentData's view manager must be set");return this._manager;}},{key:"viewConfig",get:function get(){var count=0;var propTypes={};var bubblingEvents=[];var directEvents=[];if(this.manager.customBubblingEventTypes){var events=this.manager.customBubblingEventTypes();for(var _iterator=events,_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++];}else{_i=_iterator.next();if(_i.done)break;_ref=_i.value;}var _event=_ref;bubblingEvents.push((0,_RCTEventDispatcher.normalizeInputEventName)(_event));}}var propDescription=this.manager.describeProps();propDescription.viewProps.concat(propDescription.shadowProps).forEach(function(_ref2){var name=_ref2.name,type=_ref2.type,nativeOnly=_ref2.nativeOnly;if(!nativeOnly){if(type==="RCTBubblingEventBlock"){bubblingEvents.push((0,_RCTEventDispatcher.normalizeInputEventName)(name));propTypes[name]="BOOL";}else if(type==="RCTDirectEventBlock"){directEvents.push((0,_RCTEventDispatcher.normalizeInputEventName)(name));propTypes[name]="BOOL";}else{propTypes[name]=type;}}});return{propTypes:propTypes,bubblingEvents:bubblingEvents,directEvents:directEvents,baseModuleName:null};}},{key:"propConfig",get:function get(){if(this._propConfig==null){this._propConfig=this.generatePropConfig(this.manager.describeProps().viewProps);}return this._propConfig;}},{key:"shadowPropConfig",get:function get(){if(this._shadowPropConfig==null){this._shadowPropConfig=this.generatePropConfig(this.manager.describeProps().shadowProps);}return this._shadowPropConfig;}}]);return RCTComponentData;}();var _default=RCTComponentData;exports.default=_default;
//# sourceMappingURL=RCTComponentData.js.map