var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _RCTModule2=_interopRequireDefault(require("./../../bridge/RCTModule"));var RCTImageLoader=function(_RCTModule){(0,_inherits2.default)(RCTImageLoader,_RCTModule);function RCTImageLoader(bridge){var _this;(0,_classCallCheck2.default)(this,RCTImageLoader);_this=(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(RCTImageLoader).call(this,bridge));_this.imageCache={};return _this;}(0,_createClass2.default)(RCTImageLoader,[{key:"loadImage",value:function loadImage(url){var _this2=this;var loadPromise=new Promise(function(resolve,reject){var image=new Image();if(url.startsWith("data:")){image.src=url;return resolve(image);}if(url.startsWith("blob:")){var blob=_this2.bridge.blobManager.resolveURL(url);url=URL.createObjectURL(blob);}image.onload=function(){return resolve(image);};image.onerror=function(){return reject();};image.src=url;});this.imageCache[url]=loadPromise;return loadPromise;}},{key:"getImagePromise",value:function getImagePromise(url){var existingImage=this.imageCache[url];if(existingImage!=null){return existingImage;}return this.loadImage(url);}},{key:"loadImageWithURLRequest",value:function loadImageWithURLRequest(url){return this.getImagePromise(url);}},{key:"getImageSizeForURLRequest",value:function getImageSizeForURLRequest(url){return this.getImagePromise(url).then(function(image){return{width:image.width,height:image.height};});}}]);return RCTImageLoader;}(_RCTModule2.default);RCTImageLoader.moduleName="RCTImageLoader";var _default=RCTImageLoader;exports.default=_default;
//# sourceMappingURL=RCTImageLoader.js.map