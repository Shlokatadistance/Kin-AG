var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _invariant=_interopRequireDefault(require("invariant"));var _RCTModule=_interopRequireDefault(require("./../../bridge/RCTModule"));var _RCTNativeAnimatedNodesManager=_interopRequireDefault(require("./RCTNativeAnimatedNodesManager"));var _RCTNativeEventEmitter=_interopRequireDefault(require("./../RCTNativeEventEmitter"));var RCTNativeAnimatedModule=function(_RCTEventEmitter){(0,_inherits2.default)(RCTNativeAnimatedModule,_RCTEventEmitter);function RCTNativeAnimatedModule(bridge){var _this;(0,_classCallCheck2.default)(this,RCTNativeAnimatedModule);_this=(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(RCTNativeAnimatedModule).call(this,bridge));_this.uiManagerWillFlushBlocks=function(uiManager){if(_this.preOperations.length===0&&_this.operations.length===0){return;}var preOperations=(0,_toConsumableArray2.default)(_this.preOperations);_this.preOperations=[];var operations=(0,_toConsumableArray2.default)(_this.operations);_this.operations=[];uiManager.prependUIBlock(function(){for(var _iterator=preOperations,_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[typeof Symbol==="function"?typeof Symbol==="function"?Symbol.iterator:"@@iterator":"@@iterator"]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++];}else{_i=_iterator.next();if(_i.done)break;_ref=_i.value;}var _operation=_ref;_operation(_this.nodesManager);}});uiManager.addUIBlock(function(){for(var _iterator2=operations,_isArray2=Array.isArray(_iterator2),_i2=0,_iterator2=_isArray2?_iterator2:_iterator2[typeof Symbol==="function"?typeof Symbol==="function"?Symbol.iterator:"@@iterator":"@@iterator"]();;){var _ref2;if(_isArray2){if(_i2>=_iterator2.length)break;_ref2=_iterator2[_i2++];}else{_i2=_iterator2.next();if(_i2.done)break;_ref2=_i2.value;}var _operation2=_ref2;_operation2(_this.nodesManager);}_this.nodesManager.updateAnimations();});};_this.bridge=bridge;_this.nodesManager=new _RCTNativeAnimatedNodesManager.default(_this.bridge.uiManager);_this.operations=[];_this.preOperations=[];_this.bridge.eventDispatcher.addDispatchObserver((0,_assertThisInitialized2.default)((0,_assertThisInitialized2.default)(_this)));_this.bridge.uiManager.observerCoordinator.addObserver((0,_assertThisInitialized2.default)((0,_assertThisInitialized2.default)(_this)));return _this;}(0,_createClass2.default)(RCTNativeAnimatedModule,[{key:"$createAnimatedNode",value:function $createAnimatedNode(tag,config){this.addOperationBlock(function(nodesManager){nodesManager.createAnimatedNode(tag,config);});}},{key:"$connectAnimatedNodes",value:function $connectAnimatedNodes(parentTag,childTag){this.addOperationBlock(function(nodesManager){nodesManager.connectAnimatedNodes(parentTag,childTag);});}},{key:"$disconnectAnimatedNodes",value:function $disconnectAnimatedNodes(parentTag,childTag){this.addOperationBlock(function(nodesManager){nodesManager.disconnectAnimatedNodes(parentTag,childTag);});}},{key:"$startAnimatingNode",value:function $startAnimatingNode(animationId,nodeTag,config,endCallbackId){var endCallback=this.bridge.callbackFromId(endCallbackId);this.addOperationBlock(function(nodesManager){nodesManager.startAnimatingNode(animationId,nodeTag,config,endCallback);});}},{key:"$stopAnimation",value:function $stopAnimation(animationId){this.addOperationBlock(function(nodesManager){nodesManager.stopAnimation(animationId);});}},{key:"$setAnimatedNodeValue",value:function $setAnimatedNodeValue(nodeTag,value){this.addOperationBlock(function(nodesManager){nodesManager.setAnimatedNodeValue(nodeTag,value);});}},{key:"$setAnimatedNodeOffset",value:function $setAnimatedNodeOffset(nodeTag,offset){this.addOperationBlock(function(nodesManager){nodesManager.setAnimatedNodeOffset(nodeTag,offset);});}},{key:"$flattenAnimatedNodeOffset",value:function $flattenAnimatedNodeOffset(nodeTag){this.addOperationBlock(function(nodesManager){nodesManager.flattenAnimatedNodeOffset(nodeTag);});}},{key:"$extractAnimatedNodeOffset",value:function $extractAnimatedNodeOffset(nodeTag){this.addOperationBlock(function(nodesManager){nodesManager.extractAnimatedNodeOffset(nodeTag);});}},{key:"$connectAnimatedNodeToView",value:function $connectAnimatedNodeToView(nodeTag,viewTag){var viewName=this.bridge.uiManager.viewNameForReactTag(viewTag);(0,_invariant.default)(viewName,"No such viewName for react tag "+viewTag);this.addOperationBlock(function(nodesManager){nodesManager.connectAnimatedNodeToView(nodeTag,viewTag,viewName);});}},{key:"$disconnectAnimatedNodeFromView",value:function $disconnectAnimatedNodeFromView(nodeTag,viewTag){this.addPreOperationBlock(function(nodesManager){nodesManager.disconnectAnimatedNodeFromView(nodeTag,viewTag);});}},{key:"$dropAnimatedNode",value:function $dropAnimatedNode(tag){this.addOperationBlock(function(nodesManager){nodesManager.dropAnimatedNode(tag);});}},{key:"$startListeningToAnimatedNodeValue",value:function $startListeningToAnimatedNodeValue(tag){var _this2=this;var valueObserver=this;this.addOperationBlock(function(nodesManager){_this2.addListener("onAnimatedValueUpdate");nodesManager.startListeningToAnimatedNodeValue(tag,valueObserver);});}},{key:"$stopListeningToAnimatedNodeValue",value:function $stopListeningToAnimatedNodeValue(tag){var _this3=this;this.addOperationBlock(function(nodesManager){_this3.removeListener("onAnimatedValueUpdate");nodesManager.stopListeningToAnimatedNodeValue(tag);});}},{key:"$addAnimatedEventToView",value:function $addAnimatedEventToView(viewTag,eventName,eventMapping){this.addOperationBlock(function(nodesManager){nodesManager.addAnimatedEventToView(viewTag,eventName,eventMapping);});}},{key:"$removeAnimatedEventFromView",value:function $removeAnimatedEventFromView(viewTag,eventName,animatedNodeTag){this.addOperationBlock(function(nodesManager){nodesManager.removeAnimatedEventFromView(viewTag,eventName,animatedNodeTag);});}},{key:"addOperationBlock",value:function addOperationBlock(operation){this.operations.push(operation);}},{key:"addPreOperationBlock",value:function addPreOperationBlock(operation){this.preOperations.push(operation);}},{key:"supportedEvents",value:function supportedEvents(){return["onAnimatedValueUpdate"];}},{key:"animatedNodeDidUpdateValue",value:function animatedNodeDidUpdateValue(node,value){this.sendEventWithName("onAnimatedValueUpdate",{tag:node.nodeTag,value:value});}},{key:"eventDispatcherWillDispatchEvent",value:function eventDispatcherWillDispatchEvent(event){this.nodesManager.handleAnimatedEvent(event);}}]);return RCTNativeAnimatedModule;}(_RCTNativeEventEmitter.default);RCTNativeAnimatedModule.moduleName="RCTNativeAnimatedModule";var _default=RCTNativeAnimatedModule;exports.default=_default;
//# sourceMappingURL=RCTNativeAnimatedModule.js.map